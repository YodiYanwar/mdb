select badgenumber,ssn,name,(def.userid)as userid,abc.tanggal,w_subuh,w_zuhur,dd.w_ashar,ee.w_magrib,ff.w_isya,gg.w_malam from 
(select (aaaaaaa.userid)as userid,aaaaaa.tanggal,w_subuh,w_zuhur,dd.w_ashar,ee.w_magrib,ff.w_isya,gg.w_malam from (select aaaaaa.userid,aaaaa.tanggal,w_subuh,w_zuhur,dd.w_ashar,ee.w_magrib,ff.w_isya from (select aaaaa.userid,aaaaa.tanggal,w_subuh,w_zuhur,dd.w_ashar,ee.w_magrib from (select aaaa.userid,aaaa.tanggal,w_subuh,w_zuhur,dd.w_ashar from (select aaa.userid,aaa.tanggal,w_subuh,w_zuhur from (select aa.userid,aa.tanggal,bb.w_subuh from (select userid,format(checktime,'dd/MM/yyyy')as tanggal from checkinout where checktime >=#01/09/2017# and checktime <=#10/09/2017# group by userid,format(checktime,'dd/MM/yyyy'))aa left join  
(select userid,max(subuh)as w_subuh,tanggal from (select userid,subuh,subuh_dari,subuh_sampai,tanggal from (select format(checktime,'hh:mm:ss')as subuh,userid,format(checktime,'dd/MM/yyyy')as tanggal from checkinout where checktime>=#01/09/2017# and checktime <=#10/09/2017#)b left join (select top 1 id_waktu,subuh_dari,subuh_sampai from t_setting where status='A' order by id_waktu desc)a on a.subuh_dari<=b.subuh and a.subuh_sampai >= b.subuh) where subuh_dari is not null group by userid,tanggal)bb on aa.userid=bb.userid and aa.tanggal=bb.tanggal)aaa Left Join (select userid,max(zuhur)as w_zuhur,tanggal from (select userid,zuhur,zuhur_dari,zuhur_sampai,tanggal from  
(select format(checktime,'hh:mm:ss')as zuhur,userid,format(checktime,'dd/MM/yyyy')as tanggal from checkinout where checktime>=#01/09/2017# and checktime <=#10/09/2017#)b left join (select top 1 id_waktu,zuhur_dari,zuhur_sampai from t_setting where status='A' order by id_waktu desc)a on a.zuhur_dari<=b.zuhur and a.zuhur_sampai >= b.zuhur) where zuhur_dari is not null group by userid,tanggal)cc on aaa.userid=cc.userid and aaa.tanggal=cc.tanggal)aaaa Left Join (select userid,max(ashar)as w_ashar,tanggal from (select userid,ashar,ashar_dari,ashar_sampai,tanggal from (select format(checktime,'hh:mm:ss')as ashar,userid,format(checktime,'dd/MM/yyyy')as tanggal from checkinout where checktime>=#01/09/2017# and checktime <=#10/09/2017#)b left join  
(select top 1 id_waktu,ashar_dari,ashar_sampai from t_setting where status='A' order by id_waktu desc)a on a.ashar_dari<=b.ashar and a.ashar_sampai >= b.ashar) where ashar_dari is not null group by userid,tanggal)dd on aaaa.userid=dd.userid and aaaa.tanggal=dd.tanggal)aaaaa Left Join (select userid,max(magrib)as w_magrib,tanggal from (select userid,magrib,magrib_dari,magrib_sampai,tanggal from (select format(checktime,'hh:mm:ss')as magrib,userid,format(checktime,'dd/MM/yyyy')as tanggal from checkinout where checktime>=#01/09/2017# and checktime <=#10/09/2017#)b left join (select top 1 id_waktu,magrib_dari,magrib_sampai from t_setting where status='A' order by id_waktu desc)a on a.magrib_dari<=b.magrib and a.magrib_sampai >= b.magrib) where magrib_dari is not null group by userid,tanggal)ee on aaaaa.userid=ee.userid and aaaaa.tanggal=ee.tanggal)aaaaaa  
Left Join (select userid,max(isya)as w_isya,tanggal from (select userid,isya,isya_dari,isya_sampai,tanggal from (select format(checktime,'hh:mm:ss')as isya,userid,format(checktime,'dd/MM/yyyy')as tanggal from checkinout where checktime>=#01/09/2017# and checktime <=#10/09/2017#)b left join (select top 1 id_waktu,isya_dari,isya_sampai from t_setting where status='A' order by id_waktu desc)a on a.isya_dari<=b.isya and a.isya_sampai >= b.isya) where isya_dari is not null group by userid,tanggal)ff on aaaaaa.userid=ff.userid and aaaaaa.tanggal=ff.tanggal)aaaaaaa Left Join (select userid,max(malam)as w_malam,tanggal from (select userid,malam,isya_sampai,batas_malam,tanggal from  
(select format(checktime,'hh:mm:ss')as malam,userid,format(checktime,'dd/MM/yyyy')as tanggal from checkinout where checktime>=#01/09/2017# and checktime <=#10/09/2017#)b left join (select top 1 id_waktu,isya_sampai,batas_malam from t_setting where status='A' order by id_waktu desc)a on a.isya_sampai<=b.malam and a.batas_malam >= b.malam) where isya_sampai is not null group by userid,tanggal)gg on aaaaaaa.userid=gg.userid and aaaaaaa.tanggal=gg.tanggal)abc right outer join  
(select userid,badgenumber,ssn,name from userinfo)def on abc.userid=def.userid order by def.userid,abc.tanggal